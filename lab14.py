# Дан текстовый файл с некоторым текстом на русском или английском языках
# произвольной длины (организовать чтение). Выбрав некоторую хеш-функцию, создать хеш-таблицу с:
# Лаба №14 “со списками”

import hashlib  # Импортируем библиотеку для работы с хеш-функциями

def sha256_hash_function(word):
    """
    Хеш-функция на основе алгоритма SHA-256.
    Преобразует строку в уникальное числовое значение.

    :param word: Слово для хеширования.
    :return: Числовое значение хеша.
    """
    sha256 = hashlib.sha256()  # Создаем объект хеш-функции SHA-256
    sha256.update(word.encode('utf-8'))  # Кодируем строку в байты и добавляем в хеш-функцию
    return int(sha256.hexdigest(), 16)  # Преобразуем хеш из шестнадцатеричного формата в целое число


def create_hash_table(input_file, output_file):
    """
    Создает хеш-таблицу из текста файла, используя метод цепочек (списки).
    Результат сохраняется в указанный выходной файл.

    :param input_file: Имя входного файла с текстом.
    :param output_file: Имя выходного файла для записи результата.
    """
    # Читаем текст из входного файла
    with open(input_file, 'r', encoding='utf-8') as file:
        text = file.read()  # Считываем весь текст из файла

    # Разбиваем текст на отдельные слова
    words = text.split()  # Разделяем текст по пробелам

    # Определяем размер хеш-таблицы как количество слов в тексте
    hash_table_size = len(words)  # Размер таблицы = количество слов в тексте
    hash_table = [[] for _ in range(hash_table_size)]  # Инициализируем таблицу как список списков
    print(hash_table)


    for word in words:
        # Вычисляем индекс для текущего слова
        hash_value = sha256_hash_function(word) % hash_table_size

        # Добавляем слово в соответствующий список (цепочку) в таблице
        hash_table[hash_value].append(word)

    # Сохраняем содержимое хеш-таблицы в выходной файл
    with open(output_file, 'w', encoding='utf-8') as result_file:
        # Проходим по всем индексам таблицы
        for index, words_list in enumerate(hash_table):
            if words_list:  # Если список по данному индексу не пустой
                words = ', '.join(words_list)  # Объединяем слова в строку, разделяя запятыми
                result_file.write(f"{index}: {words}\n")  # Записываем индекс и список слов


# Пример использования функции
create_hash_table('input.txt', 'output14.txt')

